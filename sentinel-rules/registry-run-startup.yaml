id: native-registry-run-startup-analytic-rule
kind: Scheduled
name: NATIVE â€“ Registry Run / Startup Folder Persistence
description: |
  L3-native analytic rule for Registry Run / Startup Folder Persistence, built from the Native Detection Bible.
  Uses only native telemetry and includes ConfidenceScore, Severity and HuntingDirectives.

severity: High
requiredDataConnectors:
  - connectorId: MicrosoftThreatProtection
    dataTypes:
      - DeviceProcessEvents

query: |
  // See rules/persistence/registry-run-startup.md for full KQL with scoring and directives.

queryFrequency: 1h
queryPeriod: 1h
triggerOperator: GreaterThan
triggerThreshold: 0

suppressionEnabled: false
suppressionDuration: 6h

tactics:
  - execution

techniques:
  - T1060

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName
