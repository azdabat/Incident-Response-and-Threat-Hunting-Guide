id: native-unknown-useragent-c2-analytic-rule
kind: Scheduled
name: NATIVE â€“ Unknown or Rare User-Agent C2
description: |
  L3-native analytic rule for Unknown or Rare User-Agent C2, built from the Native Detection Bible.
  Uses only native telemetry and includes ConfidenceScore, Severity and HuntingDirectives.

severity: High
requiredDataConnectors:
  - connectorId: MicrosoftThreatProtection
    dataTypes:
      - DeviceProcessEvents

query: |
  // See rules/c2/unknown-useragent-c2.md for full KQL with scoring and directives.

queryFrequency: 1h
queryPeriod: 1h
triggerOperator: GreaterThan
triggerThreshold: 0

suppressionEnabled: false
suppressionDuration: 6h

tactics:
  - execution

techniques:
  - T1071

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName
