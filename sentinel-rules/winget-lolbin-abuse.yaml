id: native-winget-lolbin-abuse-analytic-rule
kind: Scheduled
name: NATIVE – Modern LOLBIN – Winget Package Abuse
description: |
  L3-native analytic rule for Modern LOLBIN – Winget Package Abuse, built from the Native Detection Bible.
  Uses only native telemetry and includes ConfidenceScore, Severity and HuntingDirectives.

severity: High
requiredDataConnectors:
  - connectorId: MicrosoftThreatProtection
    dataTypes:
      - DeviceProcessEvents

query: |
  // See rules/execution/winget-lolbin-abuse.md for full KQL with scoring and directives.

queryFrequency: 1h
queryPeriod: 1h
triggerOperator: GreaterThan
triggerThreshold: 0

suppressionEnabled: false
suppressionDuration: 6h

tactics:
  - execution

techniques:
  - T1218

entityMappings:
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: DeviceName
  - entityType: Account
    fieldMappings:
      - identifier: Name
        columnName: AccountName
